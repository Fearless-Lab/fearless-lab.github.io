# Fearless - LoL 밴픽 시뮬레이션

- Fearless 배포 주소 : [Fearless](https://fearless-lab.github.io/)

<br />

## 🚀 프로젝트 소개
Fearless는 리그 오브 레전드(LoL)의 밴픽(Ban & Pick) 과정을 시뮬레이션하여, 팀 전략 수립과 밴픽 연습을 돕는 웹 기반 도구입니다.
- 실시간 밴픽 진행
- 다양한 모드 지원 (토너먼트 드래프트, 소프트 피어리스, 하드 피어리스)
- 이전 세트 기록 및 스왑 기능 제공

<img width="780" height="465" alt="image" src="https://github.com/user-attachments/assets/e385b275-6c03-49ac-8d20-955734b356b8" />

<br />

## 🕒 개발 일정
- MVP 개발 : 2025.07.19 ~ 2025.08.05
- 추가 기능 개발 : 커뮤니티 기능 (미정)

<br />

## ⚠️ 기술적 고민

- 본 프로젝트는 2개 이상의 클라이언트에서 동시에 진행되는 실시간 시뮬레이션 특성상, 멀티 클라이언트 환경에서 발생하는 복잡한 동기화 문제와 상태 관리, 경쟁 조건(race condition) 등 다양한 이슈를 경험하고 해결해야 했습니다.
- 특히 내 차례, 상대 차례, 밴, 픽, 스왑, 게임 종료, 진영 선택, 다음 게임 준비 완료 여부 등 다양한 상황에 따른 세밀한 분기 처리가 필요해 로직 설계와 상태 관리가 매우 까다로웠습니다.
아래는 주요 문제와 해결 과정을 정리한 내용입니다.

### 1. 무한 리렌더링 문제
- 컴포넌트가 커지고 복잡해져 UI와 비즈니스 로직 분리를 위해 커스텀 훅(useBanPickLogic)을 도입함
- 커스텀 훅 내부에서 Firestore 관련 기능을 제공하는 외부 훅(useBanPickInit)을 호출했는데, 외부 훅이 반환하는 함수들이 useCallback으로 참조를 안정화하지 않아 매 렌더링마다 새로운 함수 참조가 생성됨
- 커스텀 훅에서 이 함수들을 useEffect 의존성 배열에 넣자, 함수 참조가 계속 바뀌면서 useEffect가 반복 실행되어 무한 리렌더링 루프에 빠짐
- 문제를 해결하려면 외부 훅에서 반환하는 함수에 useCallback을 적용해 참조를 고정시키는 것이 필요함
- 이를 통해 함수 참조 변경에 의한 불필요한 리렌더링과 무한 루프를 완전히 방지할 수 있었음  
👉 이 경험을 통해 React 훅 간 함수 참조 전달 시, 참조 안정화와 의존성 관리가 얼마나 중요한지 깨닫게 됨

### 2. 카운트다운 타이머 동기화 문제
- Firestore `onSnapshot`을 통해 실시간 데이터 변화를 감지하여 카운트다운 시작
- 단순히 `setInterval`로 타이머를 돌리면, 탭 비활성화 시 실행 지연으로 인해 클라이언트별 시간 불일치 발생
- 해결책으로 타이머 시작 기준 시간을 Firestore에 저장하여 모든 클라이언트가 서버 시간을 기준으로 경과 시간을 계산
- 클라이언트 상태에 의존하지 않고 서버 기준으로 동기화된 타이머 구현 성공

### 3. 중복 요청(race condition) 문제 해결
- 두 클라이언트(양 팀)가 동시에 다음 단계로 넘어가는 함수를 호출해 단계가 클라이언트 수만큼(2번 이상) 중복 증가하는 문제 발생
- Firestore 트랜잭션을 활용해 충돌 감지 및 자동 재시도로 중복 증가 방지
- 조건 검사를 통해 이미 반영된 변경을 다시 처리하지 않도록 구현
- 덕분에 안전하고 원자적인 단계 변경이 가능해짐  
👉 Firestore의 낙관적 동시성 제어(Optimistic Concurrency Control)를 직접 경험한 사례
